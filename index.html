<html>
   <head>
      <title>Battlezone Legends</title>
      <style>
         body { margin: 0; background-color: black; }
         canvas {
         border: 2px solid #00FF00;
         background-color: black;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translateX(-50%) translateY(-50%);
       }
      </style>
  </head>
  <body>
    <script src="js/three.js"></script>
    <script>
      class Game {
        constructor(width, height) {
          this.width = width;
          this.height = height;
            
          this.scene = new THREE.Scene();
          this.camera = new THREE.PerspectiveCamera(75, width/height, 0.1, 1000);
          this.camera.position.z = -5;
          this.camera.rotation.y += Math.PI;

          this.renderer = new THREE.WebGLRenderer();
          this.renderer.setSize(width, height);
          document.body.appendChild(this.renderer.domElement);
          
          var self = this;
          document.onkeydown = e => self.handleInput(self, e);
        }
        
        addCube(x, z) {
          var geometry = new THREE.BoxGeometry(1, 1, 1);
          var cube = this.buildShape(geometry, x, z);
          cube.rotation.y += 2;
          this.scene.add(cube);
          return cube;
        }
        
        addPyramid(x, z) {
          var geometry = new THREE.Geometry();
          geometry.vertices.push(
            new THREE.Vector3(0, 0, 0),
            new THREE.Vector3(0, 0, 1),
            new THREE.Vector3(1, 0, 1),
            new THREE.Vector3(1, 0, 0),
            new THREE.Vector3(0.5, 1, 0.5));            
          geometry.faces.push(
            new THREE.Face3(0, 2, 1),
            new THREE.Face3(0, 3, 2),
            new THREE.Face3(1, 4, 0),
            new THREE.Face3(2, 4, 1),
            new THREE.Face3(3, 4, 2),
            new THREE.Face3(0, 4, 3));
          
          var pyramid = this.buildShape(geometry, x, z);
          pyramid.position.y = -0.5;
          this.scene.add(pyramid);
          return pyramid;
        }
        
        render() {
          requestAnimationFrame(this.render);
          this.renderer.render(this.scene, this.camera);
        }
        
        buildShape(geometry, x, z) {
          var edges = new THREE.EdgesGeometry(geometry);
          var material = new THREE.LineBasicMaterial({color: 0x00ff00});
          var shape = new THREE.LineSegments(edges, material);
          shape.position.x = x;
          shape.position.z = z;
          return shape;
        }
      
        handleInput(sender, e) {
          var theta = sender.camera.rotation.y - Math.PI;
          var hyp = .1;
          var opp = hyp * Math.sin(theta);
          var adj = hyp * Math.cos(theta);
                   
          switch(e.keyCode) {
            case 38: // up
              sender.camera.position.x += opp;
              sender.camera.position.z += adj;
              break;
            case 40: // down
              sender.camera.position.x -= opp;
              sender.camera.position.z -= adj;
              break;
            case 37: // left
              sender.camera.rotation.y += .1;
              break;
            case 39: // right
              sender.camera.rotation.y -= .1;
              break;  
          }
          
          sender.render();
        }
      }
      
      var game = new Game(800, 600);
      game.addCube(1, -1.5);
      game.addCube(-3, 2.5);
      game.addCube(-1, 0);
      game.addPyramid(-2, -4);
      game.render();
    </script>
   </body>
</html>